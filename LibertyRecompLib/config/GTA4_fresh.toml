# LibertyRecomp - GTA IV Xbox 360 Recompilation Config
# Fresh recompilation to new directory

[main]
file_path = "../../Grand Theft Auto IV (USA) (En,Fr,De,Es,It)/default.xex"
out_directory_path = "../ppc_fresh"
switch_table_file_path = "./gta4_switch_tables.toml"

# Optimizations - disabled until we have a working build
skip_lr = false
skip_msr = false
ctr_as_local = false
xer_as_local = false
reserved_as_local = false
cr_as_local = false
non_argument_as_local = false
non_volatile_as_local = false

# Debug/scaling options - balanced for speed vs RAM
verbose = true                       # Print progress messages
progress_every = 500                 # Print progress every N functions
skip_auto_discovery = false          # Set to true to skip .pdata and branch scanning
cpp_chunk_functions = 128            # Functions per .cpp chunk (balanced)
disable_identical_file_check = true  # Skip file comparison to save RAM
use_lightweight_analysis = true      # Use memory-efficient analysis
max_functions_in_memory = 500        # Max functions to hold during recompilation

# Register save/restore function addresses
# Found using FindPatterns tool on GTA IV XEX
restgprlr_14_address = 0x8298EB30
savegprlr_14_address = 0x8298EAE0
restfpr_14_address = 0x8299015C
savefpr_14_address = 0x82990110
restvmx_14_address = 0x82990598
savevmx_14_address = 0x82990300
restvmx_64_address = 0x8299062C
savevmx_64_address = 0x82990394

# Explicit function boundaries for functions with jump tables
functions = [
    { address = 0x82990020, size = 0x50 },
    { address = 0x82990830, size = 0x11C },
    { address = 0x8299094C, size = 0x37C },
]

# Invalid instruction patterns to skip
invalid_instructions = [
    { data = 0x00000000, size = 4 }, # Padding
]
